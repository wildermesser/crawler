---
version: '3.3'
services:
  crawler:
    image: wildermesser/crawler:latest
    restart: always
    depends_on:
      - mongodb
      - rabbitmq
    command: sh -c './wait-for rabbitmq:5672 -t 120 -- python crawler.py https://vitkhab.github.io/search_engine_test_site/'
    environment:
      RMQ_PASSWORD: crawler
    networks:
      - crawler_net
  mongodb:
    image: mongo
    restart: always
    volumes:
      - mongo_data:/data/sb
    networks:
      - crawler_net
  rabbitmq:
    image: rabbitmq
    restart: always
    environment:
      RABBITMQ_DEFAULT_USER: crawler
      RABBITMQ_DEFAULT_PASS: crawler
    networks:
      - crawler_net
  ui:
    image: wildermesser/ui:latest
    restart: always
    depends_on:
      - crawler
    networks: 
      - crawler_net
    ports:
      - 8000:8000

networks:
  crawler_net:

volumes:
  mongo_data:




  